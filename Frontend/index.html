<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title> IPL Auction </title>
    <link rel="icon" type="image/jpeg" href="assets/icon.jpg">
    <link rel="stylesheet" href="css/IpL.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff8c00">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>
    <script>
        // Check if user is logged in; if not, send to login page
        const userInfo = localStorage.getItem('userInfo');
        console.log('index.html loaded - localStorage userInfo:', userInfo);
        if (!userInfo) {
            window.location.replace('login.html');
        }
    </script>
    <div class="wrap">
        <header>
            <div>
                <h1>IPL Auction</h1>
                <p class="small">INDIAN PREMIER LEAGUE</p>
            </div>
            <div>
                <button class="ghost" id="resetBtn">Reset</button>
            </div>
        </header>

        <!-- TEAM SELECTION -->
        <div id="team-selection" class="section">
            <h3 style="margin:0 0 8px 0">1. Select Teams </h3>

            <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap">
                <div class="friend-actions">
                    <label style="color:var(--muted);font-weight:700">Friends:</label>
                    <select id="friend-count">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3" selected>3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                </div>


                <!-- Multiplayer Room Controls -->
                <div id="multiplayerControls">
                    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
                        <button id="createRoom" style="background:#4CAF50;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer">Create Room</button>
                        <input id="roomId" placeholder="Enter Room ID" style="padding:8px;border:1px solid #ccc;border-radius:5px;min-width:120px">
                        <button id="joinRoom" style="background:#2196F3;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer">Join Room</button>
                    </div>
                    <div id="roomStatus" style="margin-top:8px;font-size:12px;color:var(--muted)">Connecting to server...</div>
                    <div id="serverStatus" style="margin-top:4px;font-size:11px;color:#ff8c00">ðŸ”„ Connecting to backend...</div>
                </div>


                <div style="display:flex;gap:8px">
                    <button class="primary" id="applyCount">Apply</button>
                    <button class="ghost" id="exampleFill">Example Fill</button>
                </div>
            </div>

            <div id="team-inputs" style="margin-top:12px"></div>

            <div class="controls">
                <button class="primary" id="startAuctionBtn">Start Auction</button>
                <button class="ghost" id="clearBtn">Clear</button>
            </div>
        </div>

        <!-- AUCTION AREA -->
        <div class="section auction-grid" id="auction-block" style="display:none">
            <div>
                <div class="player-card">
                    <img id="player-pic" class="player-img" src="" alt="player">
                    <div class="player-meta">
                        <h2 id="player-name">Player Name</h2>
                        <p><span class="muted">Country:</span> <span id="player-country"></span></p>
                        <p><span class="muted">Category:</span> <span id="player-category"></span></p>
                        <p class="muted">Base Price: â‚¹<span id="player-base"></span> Cr</p>
                    </div>
                </div>

                <div style="margin-top:12px" class="auction-controls">
                    <div class="status-row">
                        <div>
                            <div class="muted">Time left</div>
                            <div class="big" id="timer">5s</div>
                        </div>
                        <div style="text-align:right">
                            <div class="muted">Current Price</div>
                            <div class="big">â‚¹<span id="current-price">0</span> Cr</div>
                            <div class="muted">By: <span id="highest-bidder">-</span></div>
                        </div>
                    </div>

                    <div id="bid-buttons"></div>

                    <div style="margin-top:10px;display:flex;gap:8px;justify-content:center">
                        <button class="ghost" id="declineBtn">Decline / Skip</button>
                    </div>
                </div>
            </div>

            <!-- RIGHT SIDE -->
            <div>
                <div class="section" style="margin-bottom:12px">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <h4 style="margin:0 0 10px 0">Teams & Budgets</h4>
                    </div>
                    <div id="teams-list"></div>
                </div>

                <div class="section">
                    <h4 style="margin:0 0 10px 0">Auction History</h4>
                    <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
                        <button class="primary" id="nextPlayerHistoryBtn">Next Player (History)</button>
                        <button class="ghost" id="clearHistoryBtn">Clear History</button>
                     
                    </div>
                    <ul id="auction-history"></ul>
                    <button id="viewSquadBtn" onclick="viewSquads()">View Squads</button>
                    <button id="showWinnerBtn" style="display:none;">Final Results</button>
                    <div id="teams-list"></div> <!-- Squad display only idha la varum -->


                    <div id="next-players-wrap">
                        <h4 style="margin:12px 0 6px 0">ðŸ“Œ Next Players</h4>
                        <div style="display:flex;gap:8px;align-items:center;margin-bottom:6px">
                            <label style="color:var(--muted);font-weight:700">Country:</label>
                            <select id="country" onchange="filterPlayers()">
                                <option value="All">All</option>
                                <option value="India">India</option>
                                <option value="Foreign">Foreign</option>
                            </select>

                            <label style="color:var(--muted);font-weight:700">Role:</label>
                            <select id="role" onchange="filterPlayers()">
                                <option value="All">All</option>
                                <option value="Batsman">Batsman</option>
                                <option value="Bowler">Bowler</option>
                                <option value="All-Rounder">All-Rounder</option>
                                <option value="Wicket-keeper">Wicket-keeper</option>
                            </select>

                            <button class="ghost" id="toggleNextPlayersBtn">Show / Hide</button>
                        </div>

                        <table id="nextPlayersTable" class="hidden">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Country</th>
                                    <th>Role</th>
                                    <th>Base</th>
                                    <th>Points</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    
                    
                    


<h1>IPL AUCTION â€“ Live Scoreboard (10 Teams)</h1>

<!-- LIVE SCOREBOARD -->
<div class="teams" id="teamBoard"></div>

<br>


<!-- WINNER TABLE AREA -->
<div id="winnerArea" style="margin-top: 20px;"></div>
                    
                    
                    
                    
                    </div>
                </div>

            </div>
        </div>

    </div>


    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <script src="js/fix-paths.js"></script>
    <script src="js/Ipl.js"></script>
</body>

</html>